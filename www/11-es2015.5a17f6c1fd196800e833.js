(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{tmrb:function(t,i,e){"use strict";e.r(i),e.d(i,"Tab1PageModule",(function(){return D}));var n=e("TEn/"),o=e("ofXK"),s=e("3Pt+"),a=e("tyNb"),c=e("mrSG"),r=e("tk/3"),b=e("AytR"),l=e("gcOT"),h=e("fXoL"),u=e("ej43");function p(t,i){if(1&t&&(h.Lb(0,"ion-title"),h.pc(1),h.Kb()),2&t){const t=h.Vb();h.xb(1),h.rc(" Hola ",t.identity[0].NOMBRE," ")}}function d(t,i){if(1&t){const t=h.Mb();h.Lb(0,"ion-item",27),h.Tb("click",(function(){h.jc(t);const e=i.$implicit;return h.Vb(2).obraSelected(e)})),h.pc(1),h.Kb()}if(2&t){const t=i.$implicit;h.xb(1),h.sc("",t.DESCRIPCION," - ",t.OBRA,"")}}function m(t,i){if(1&t&&(h.Lb(0,"ion-list"),h.nc(1,d,2,2,"ion-item",26),h.Kb()),2&t){const t=h.Vb();h.xb(1),h.bc("ngForOf",t.items)}}function g(t,i){if(1&t){const t=h.Mb();h.Lb(0,"ion-item",27),h.Tb("click",(function(){h.jc(t);const e=i.$implicit;return h.Vb(3).maquinaSelected(e)})),h.pc(1),h.Kb()}if(2&t){const t=i.$implicit;h.xb(1),h.sc("",t.NOMBRE," - ",t.COD_MAQUINA," ")}}function f(t,i){if(1&t&&(h.Lb(0,"ion-list"),h.nc(1,g,2,2,"ion-item",26),h.Kb()),2&t){const t=h.Vb(2);h.xb(1),h.bc("ngForOf",t.itemsMachine)}}function O(t,i){if(1&t){const t=h.Mb();h.Lb(0,"ion-item",28),h.Lb(1,"ion-label",7),h.pc(2,"Maquina"),h.Kb(),h.Lb(3,"ion-input",29),h.Tb("ngModelChange",(function(i){return h.jc(t),h.Vb().maquina=i}))("ionFocus",(function(){return h.jc(t),h.Vb().checkMaquinaFocus()}))("ionInput",(function(i){return h.jc(t),h.Vb().getMachines(i)})),h.Kb(),h.nc(4,f,2,1,"ion-list",1),h.Kb()}if(2&t){const t=h.Vb();h.xb(3),h.bc("ngModel",t.maquina),h.xb(1),h.bc("ngIf",t.isMachineAvailable)}}function M(t,i){if(1&t&&(h.Lb(0,"ion-select-option",32),h.pc(1),h.Kb()),2&t){const t=i.$implicit;h.bc("value",t.COD_INTERNO),h.xb(1),h.qc(t.NOMBRE)}}function L(t,i){if(1&t){const t=h.Mb();h.Lb(0,"ion-item",4),h.Lb(1,"ion-label",7),h.pc(2,"Precios"),h.Kb(),h.Lb(3,"ion-select",30),h.Tb("ngModelChange",(function(i){return h.jc(t),h.Vb().precio=i})),h.nc(4,M,2,2,"ion-select-option",31),h.Kb(),h.Kb()}if(2&t){const t=h.Vb();h.xb(3),h.bc("ngModel",t.precio),h.xb(1),h.bc("ngForOf",t.precios)}}function I(t,i){if(1&t&&(h.Lb(0,"ion-select-option",32),h.pc(1),h.Kb()),2&t){const t=i.$implicit;h.bc("value",t.CAPITULO),h.xb(1),h.qc(t.NOMBRE)}}function C(t,i){if(1&t){const t=h.Mb();h.Lb(0,"ion-item",4),h.Lb(1,"ion-label",7),h.pc(2,"Cap\xedtulo"),h.Kb(),h.Lb(3,"ion-select",33),h.Tb("ngModelChange",(function(i){return h.jc(t),h.Vb().capitulo=i})),h.nc(4,I,2,2,"ion-select-option",31),h.Kb(),h.Kb()}if(2&t){const t=h.Vb();h.xb(3),h.bc("ngModel",t.capitulo),h.xb(1),h.bc("ngForOf",t.capitulos)}}function v(t,i){if(1&t){const t=h.Mb();h.Lb(0,"ion-item-sliding"),h.Lb(1,"ion-item"),h.Lb(2,"ion-label"),h.pc(3),h.Kb(),h.Kb(),h.Lb(4,"ion-item-options"),h.Lb(5,"ion-item-option",35),h.Tb("click",(function(){h.jc(t);const e=i.$implicit;return h.Vb(2).delete(e)})),h.Jb(6,"ion-icon",36),h.Kb(),h.Kb(),h.Kb()}if(2&t){const t=i.$implicit;h.xb(3),h.sc(" ",t.DESCRIPCION,", ",t.CANTIDAD," h ")}}function y(t,i){if(1&t&&(h.Lb(0,"div"),h.nc(1,v,7,2,"ion-item-sliding",34),h.Kb()),2&t){const t=h.Vb();h.xb(1),h.bc("ngForOf",t.tareas)}}const{Storage:A}=l.a,K=[{path:"",component:(()=>{class t{constructor(t,i,e,n,o,s){this.navCtrl=t,this.loading=i,this.router=e,this.alert=n,this.authService=o,this.http=s,this.myDate=(new Date).toISOString(),this.maxDate=(new Date).toISOString(),this.observations="",this.numHours=0,this.isItemAvailable=!1,this.isMachineAvailable=!1,this.showPrecios=!1,this.items=[],this.itemsMachine=[],this.capitulo="",this.tipo="P",this.maquina="",this.load()}initializeItems(){this.items=["Obra1 - 1234","Obra2 - 4321","Obra3 - 7894"]}ngOnInit(){this.load()}getItems(t){const i=t.target.value;this.items=this.obras,i&&""!==i.trim()?(this.isItemAvailable=!0,this.items=this.items.filter(t=>(console.log(t),t.DESCRIPCION.toLowerCase().indexOf(i.toLowerCase())>-1||t.OBRA.toLowerCase().indexOf(i.toLowerCase())>-1))):this.isItemAvailable=!1}getMachines(t){const i=t.target.value;this.itemsMachine=this.maquinas,i&&""!==i.trim()?(this.isMachineAvailable=!0,this.itemsMachine=this.itemsMachine.filter(t=>(console.log(t),t.NOMBRE.toLowerCase().indexOf(i.toLowerCase())>-1||t.COD_MAQUINA.toLowerCase().indexOf(i.toLowerCase())>-1))):this.isMachineAvailable=!1}obraSelected(t){this.obra=t.DESCRIPCION,this.obra_id=t.OBRA,this.isItemAvailable=!1,this.http.get(b.a.API+"/empresa/"+t.EMPRESA).subscribe(t=>{this.empresa=t,this.empresa=JSON.parse(this.empresa),this.empresa=this.empresa[0]}),this.http.get(b.a.API+"/capitulo/"+t.OBRA).subscribe(t=>{this.capitulos=t,this.capitulos=JSON.parse(this.capitulos),this.capitulo=""})}maquinaSelected(t){this.maquina=t.COD_MAQUINA,this.isMachineAvailable=!1,this.http.get(b.a.API+"/precios/"+t.COD_MAQUINA).subscribe(t=>{this.precios=t,this.precios=JSON.parse(this.precios),console.log(this.precios),1==this.precios.length?(this.precio=this.precios[0].COD_INTERNO,this.showPrecios=!1):this.showPrecios=!0})}load(){return Object(c.a)(this,void 0,void 0,(function*(){let t=this.loading.create({message:"Por favor espere..."});(yield t).present();let i=yield A.get({key:"my-token"});if(i=JSON.parse(i.value),console.log(i),null!=i){this.identity=i,console.log(this.identity);try{this.http.get(b.a.API+"/"+this.identity[0].EMPRESA).subscribe(t=>Object(c.a)(this,void 0,void 0,(function*(){this.obras=t,this.obras=JSON.parse(this.obras),this.http.get(b.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe(t=>{this.total=0,this.tareas=t,this.tareas=JSON.parse(this.tareas);for(let i=0;i<this.tareas.length;i++)this.tareas[i].CANTIDAD=parseFloat(this.tareas[i].CANTIDAD).toFixed(2),this.total=(parseFloat(this.tareas[i].CANTIDAD)+parseFloat(this.total||0)).toFixed(1);this.http.get(b.a.API+"/maquinas").subscribe(t=>{this.maquinas=t,this.maquinas=JSON.parse(this.maquinas),console.log(this.maquinas)})},t=>Object(c.a)(this,void 0,void 0,(function*(){this.load()})))})),t=>Object(c.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al cargar los datos.",buttons:[{text:"Ok",role:"cancel",handler:()=>{this.load()}}]});yield t.present()}))),(yield t).dismiss()}catch(e){(yield t).dismiss(),this.salir()}}else(yield t).dismiss(),this.salir()}))}save(){return Object(c.a)(this,void 0,void 0,(function*(){if(null!=this.empresa&&null!=this.obra_id&&null!=this.identity[0]&&null!=this.numHours&&null!=this.observations){let t={empresa:this.empresa.EMPRESA,obra:this.obra_id,fecha:this.myDate.slice(0,10),codigo:this.identity[0].COD_PERSONAL,descripcion:this.observations,cantidad:this.numHours,tipo:this.tipo,codigo_maquina:this.maquina,capitulo:this.capitulo,precio_maquina:this.precio},i=this.loading.create({message:"Por favor espere..."});(yield i).present();let e=(new r.c).set("Content-Type","application/json").set("Accept","*/*");yield this.http.post(b.a.API+"/save/",t,{headers:e}).subscribe(t=>Object(c.a)(this,void 0,void 0,(function*(){yield this.http.get(b.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe(t=>{this.total=0,this.tareas=t,this.tareas=JSON.parse(this.tareas);for(let i=0;i<this.tareas.length;i++)this.tareas[i].CANTIDAD=parseFloat(this.tareas[i].CANTIDAD).toFixed(2),this.total=(parseFloat(this.tareas[i].CANTIDAD)+parseFloat(this.total||0)).toFixed(1)}),this.observations="",this.maquina="",this.capitulo="",this.numHours=0,this.obra=null,this.showPrecios=!1,(yield i).dismiss()})),t=>Object(c.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al enviar tu trabajo.",buttons:["OK"]});(yield i).dismiss(),yield t.present()})))}else{console.log(this.empresa,this.obra_id,this.identity[0],this.numHours);const t=yield this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Por favor rellene el formulario .",buttons:["OK"]});yield t.present()}}))}salir(){return Object(c.a)(this,void 0,void 0,(function*(){yield this.authService.logout(),this.router.navigateByUrl("/",{replaceUrl:!0})}))}checkFocus(){this.isItemAvailable=!0,this.items=this.obras}checkMaquinaFocus(){this.isMachineAvailable=!0,this.itemsMachine=this.maquinas}incrementQty(){this.numHours+=1}byPassValue(){this.numHours<0&&(this.numHours=0),console.log(this.numHours)}decrementQty(){this.numHours<=0?this.numHours=0:this.numHours-=1}delete(t){this.http.delete(b.a.API+"/delete/"+t.LINEA+"/"+t.OBRA+"/"+this.identity[0].COD_PERSONAL).subscribe(t=>Object(c.a)(this,void 0,void 0,(function*(){yield this.http.get(b.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe(t=>{this.total=0,this.tareas=t,this.tareas=JSON.parse(this.tareas);for(let i=0;i<this.tareas.length;i++)this.tareas[i].CANTIDAD=parseFloat(this.tareas[i].CANTIDAD).toFixed(2),this.total=(parseFloat(this.tareas[i].CANTIDAD)+parseFloat(this.total||0)).toFixed(1);console.log(this.tareas)})})))}}return t.\u0275fac=function(i){return new(i||t)(h.Ib(n.H),h.Ib(n.F),h.Ib(a.g),h.Ib(n.a),h.Ib(u.a),h.Ib(r.a))},t.\u0275cmp=h.Cb({type:t,selectors:[["app-tab1"]],decls:58,vars:18,consts:[[3,"translucent"],[4,"ngIf"],["slot","end"],[3,"fullscreen"],["lines","full"],["position","stacked"],["type","text","debounce","600","name","obra","placeholder","Buscar obra",3,"ngModel","ngModelChange","ionInput","ionFocus"],["position","floating"],["no-padding",""],["no-padding","","justify-content-start","","align-items-start",""],["size","auto","ion-item","","no-lines","","no-padding","","text-center","","col-2",""],["color","primary",3,"click"],["name","remove-outline"],["ion-item","","no-lines","","no-padding","","text-center","","col-2",""],["name","numhours","pattern","^[1-9]{1,3}$|^[0-9]{1,3}\\.[0-9]{1,3}$","clearOnEdit","true","inputmode","numeric","min","0","type","number","required","",3,"ngModel","ngModelChange","ionInput"],["name","add-outline"],["name","type","okText","Okay","cancelText","Cancelar",3,"value","ngModel","ngModelChange"],["value","M"],["value","P"],["value","X"],["lines","none",4,"ngIf"],["lines","full",4,"ngIf"],["name","observations","placeholder","Tus observaciones...",3,"ngModel","ngModelChange"],["name","time","displayFormat","DD/MM/YYYY","pickerFormat","DD/MM/YYYY",3,"ngModel","max","ngModelChange","maxChange"],["type","button","color","danger","expand","block",3,"click"],["type","submit","color","success","expand","block",3,"disabled","click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["lines","none"],["debounce","600","name","maquina","clearOnEdit","true","required","",3,"ngModel","ngModelChange","ionFocus","ionInput"],["name","cap",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["interface","action-sheet","name","cap",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["color","danger",3,"click"],["name","trash"]],template:function(t,i){1&t&&(h.Lb(0,"ion-header",0),h.Lb(1,"ion-toolbar"),h.nc(2,p,2,1,"ion-title",1),h.Lb(3,"h4",2),h.pc(4),h.Kb(),h.Kb(),h.Kb(),h.Lb(5,"ion-content",3),h.Lb(6,"form"),h.Lb(7,"ion-item",4),h.Lb(8,"ion-label",5),h.pc(9,"Obra"),h.Kb(),h.Lb(10,"ion-searchbar",6),h.Tb("ngModelChange",(function(t){return i.obra=t}))("ionInput",(function(t){return i.getItems(t)}))("ionFocus",(function(){return i.checkFocus()})),h.Kb(),h.nc(11,m,2,1,"ion-list",1),h.Kb(),h.Lb(12,"ion-item",4),h.Lb(13,"ion-label",7),h.pc(14,"Horas"),h.Kb(),h.Lb(15,"ion-grid",8),h.Lb(16,"ion-row",9),h.Lb(17,"ion-col",10),h.Lb(18,"ion-fab-button",11),h.Tb("click",(function(){return i.decrementQty()})),h.Jb(19,"ion-icon",12),h.Kb(),h.Kb(),h.Lb(20,"ion-col",13),h.Lb(21,"ion-input",14),h.Tb("ngModelChange",(function(t){return i.numHours=t}))("ionInput",(function(){return i.byPassValue()})),h.Kb(),h.Kb(),h.Lb(22,"ion-col",10),h.Lb(23,"ion-fab-button",11),h.Tb("click",(function(){return i.incrementQty()})),h.Jb(24,"ion-icon",15),h.Kb(),h.Kb(),h.Kb(),h.Kb(),h.Kb(),h.Lb(25,"ion-item",4),h.Lb(26,"ion-label",7),h.pc(27,"Tipo"),h.Kb(),h.Lb(28,"ion-select",16),h.Tb("ngModelChange",(function(t){return i.tipo=t})),h.Lb(29,"ion-select-option",17),h.pc(30,"Maquina"),h.Kb(),h.Lb(31,"ion-select-option",18),h.pc(32,"Persona"),h.Kb(),h.Lb(33,"ion-select-option",19),h.pc(34,"Mixto"),h.Kb(),h.Kb(),h.Kb(),h.nc(35,O,5,2,"ion-item",20),h.nc(36,L,5,2,"ion-item",21),h.nc(37,C,5,2,"ion-item",21),h.Lb(38,"ion-item",4),h.Lb(39,"ion-label",7),h.pc(40,"Observaciones"),h.Kb(),h.Lb(41,"ion-textarea",22),h.Tb("ngModelChange",(function(t){return i.observations=t})),h.Kb(),h.Kb(),h.Lb(42,"ion-item",4),h.Lb(43,"ion-label",7),h.pc(44,"Fecha"),h.Kb(),h.Lb(45,"ion-datetime",23),h.Tb("ngModelChange",(function(t){return i.myDate=t}))("maxChange",(function(t){return i.maxDate=t})),h.Kb(),h.Kb(),h.Lb(46,"ion-row"),h.Lb(47,"ion-col"),h.Lb(48,"ion-button",24),h.Tb("click",(function(){return i.salir()})),h.pc(49,"Salir"),h.Kb(),h.Kb(),h.Lb(50,"ion-col"),h.Lb(51,"ion-button",25),h.Tb("click",(function(){return i.save()})),h.pc(52," Aceptar"),h.Kb(),h.Kb(),h.Kb(),h.Kb(),h.Lb(53,"ion-header",0),h.Lb(54,"ion-toolbar"),h.Lb(55,"ion-title"),h.pc(56,"Tus obras"),h.Kb(),h.Kb(),h.Kb(),h.nc(57,y,2,1,"div",1),h.Kb()),2&t&&(h.bc("translucent",!0),h.xb(2),h.bc("ngIf",i.identity),h.xb(2),h.rc("",i.total," h"),h.xb(1),h.bc("fullscreen",!0),h.xb(5),h.bc("ngModel",i.obra),h.xb(1),h.bc("ngIf",i.isItemAvailable),h.xb(10),h.bc("ngModel",i.numHours),h.xb(7),h.bc("value",i.tipo)("ngModel",i.tipo),h.xb(7),h.bc("ngIf","P"!=i.tipo),h.xb(1),h.bc("ngIf",i.showPrecios),h.xb(1),h.bc("ngIf",i.capitulos),h.xb(4),h.bc("ngModel",i.observations),h.xb(4),h.bc("ngModel",i.myDate)("max",i.maxDate),h.xb(6),h.bc("disabled",!i.obra||!i.numHours||i.numHours<=0||""===i.capitulo||"M"==i.tipo&&""===i.maquina&&""===i.precio||"X"==i.tipo&&""===i.maquina&&""===i.precio),h.xb(2),h.bc("translucent",!0),h.xb(4),h.bc("ngIf",i.tareas))},directives:[n.j,n.C,o.j,n.f,s.n,s.h,s.i,n.m,n.q,n.u,n.L,s.g,s.j,n.i,n.t,n.e,n.h,n.k,n.l,n.I,s.k,s.m,n.v,n.K,n.w,n.A,n.g,n.c,n.B,n.r,o.i,n.p,n.o,n.n],styles:["h4[_ngcontent-%COMP%]{margin-right:1rem}ion-label[_ngcontent-%COMP%]{opacity:1!important}ion-fab-button[_ngcontent-%COMP%]{width:40px;height:40px}ion-row[_ngcontent-%COMP%]{margin-top:.5rem}"]}),t})()}];let x=(()=>{class t{}return t.\u0275mod=h.Gb({type:t}),t.\u0275inj=h.Fb({factory:function(i){return new(i||t)},imports:[[a.i.forChild(K)],a.i]}),t})(),D=(()=>{class t{}return t.\u0275mod=h.Gb({type:t}),t.\u0275inj=h.Fb({factory:function(i){return new(i||t)},imports:[[n.D,o.b,s.d,x]]}),t})()}}]);