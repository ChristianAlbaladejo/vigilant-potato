(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{tmrb:function(t,e,i){"use strict";i.r(e),i.d(e,"Tab1PageModule",(function(){return v}));var n=i("TEn/"),o=i("ofXK"),a=i("3Pt+"),s=i("tyNb"),r=i("mrSG"),c=i("tk/3"),l=i("AytR"),b=i("fXoL");function h(t,e){if(1&t&&(b.Lb(0,"ion-title"),b.pc(1),b.Kb()),2&t){const t=b.Vb();b.xb(1),b.rc(" Hola ",t.identity[0].NOMBRE," ")}}function u(t,e){if(1&t){const t=b.Mb();b.Lb(0,"ion-item",21),b.Tb("click",(function(){b.jc(t);const i=e.$implicit;return b.Vb(2).obraSelected(i)})),b.pc(1),b.Kb()}if(2&t){const t=e.$implicit;b.xb(1),b.sc("",t.DESCRIPCION," - ",t.OBRA,"")}}function d(t,e){if(1&t&&(b.Lb(0,"ion-list"),b.nc(1,u,2,2,"ion-item",20),b.Kb()),2&t){const t=b.Vb();b.xb(1),b.bc("ngForOf",t.items)}}function p(t,e){if(1&t){const t=b.Mb();b.Lb(0,"ion-input",22),b.Tb("ngModelChange",(function(e){return b.jc(t),b.Vb().empresa.DESCRIPCION=e})),b.Kb()}if(2&t){const t=b.Vb();b.bc("ngModel",t.empresa.DESCRIPCION)("readonly",!0)}}function m(t,e){if(1&t){const t=b.Mb();b.Lb(0,"ion-item",21),b.Tb("click",(function(){b.jc(t);const i=e.$implicit;return b.Vb(3).maquinaSelected(i)})),b.pc(1),b.Kb()}if(2&t){const t=e.$implicit;b.xb(1),b.sc("",t.NOMBRE," - ",t.COD_MAQUINA,"")}}function g(t,e){if(1&t&&(b.Lb(0,"ion-list"),b.nc(1,m,2,2,"ion-item",20),b.Kb()),2&t){const t=b.Vb(2);b.xb(1),b.bc("ngForOf",t.itemsMachine)}}function f(t,e){if(1&t){const t=b.Mb();b.Lb(0,"ion-item",23),b.Lb(1,"ion-label",7),b.pc(2,"Maquina"),b.Kb(),b.Lb(3,"ion-input",24),b.Tb("ngModelChange",(function(e){return b.jc(t),b.Vb().maquina=e}))("ionInput",(function(e){return b.jc(t),b.Vb().getMachines(e)})),b.Kb(),b.nc(4,g,2,1,"ion-list",1),b.Kb()}if(2&t){const t=b.Vb();b.xb(3),b.bc("ngModel",t.maquina),b.xb(1),b.bc("ngIf",t.isMachineAvailable)}}function M(t,e){if(1&t&&(b.Lb(0,"ion-select-option",27),b.pc(1),b.Kb()),2&t){const t=e.$implicit;b.bc("value",t.CAPITULO),b.xb(1),b.qc(t.NOMBRE)}}function O(t,e){if(1&t){const t=b.Mb();b.Lb(0,"ion-item",4),b.Lb(1,"ion-label",7),b.pc(2,"Cap\xedtulo"),b.Kb(),b.Lb(3,"ion-select",25),b.Tb("ngModelChange",(function(e){return b.jc(t),b.Vb().capitulo=e})),b.nc(4,M,2,2,"ion-select-option",26),b.Kb(),b.Kb()}if(2&t){const t=b.Vb();b.xb(3),b.bc("ngModel",t.capitulo),b.xb(1),b.bc("ngForOf",t.capitulos)}}function C(t,e){if(1&t){const t=b.Mb();b.Lb(0,"ion-item-sliding"),b.Lb(1,"ion-item"),b.Lb(2,"ion-label"),b.pc(3),b.Kb(),b.Kb(),b.Lb(4,"ion-item-options"),b.Lb(5,"ion-item-option",29),b.Tb("click",(function(){b.jc(t);const i=e.$implicit;return b.Vb(2).delete(i)})),b.Jb(6,"ion-icon",30),b.Kb(),b.Kb(),b.Kb()}if(2&t){const t=e.$implicit;b.xb(3),b.sc(" ",t.DESCRIPCION,", ",t.CANTIDAD," h ")}}function I(t,e){if(1&t&&(b.Lb(0,"div"),b.nc(1,C,7,2,"ion-item-sliding",28),b.Kb()),2&t){const t=b.Vb();b.xb(1),b.bc("ngForOf",t.tareas)}}const L=[{path:"",component:(()=>{class t{constructor(t,e,i,n,o){this.navCtrl=t,this.loading=e,this.router=i,this.alert=n,this.http=o,this.myDate=(new Date).toISOString(),this.maxDate=(new Date).toISOString(),this.observations="",this.isItemAvailable=!1,this.isMachineAvailable=!1,this.items=[],this.itemsMachine=[],this.capitulo="",this.tipo="P",this.maquina="",this.load()}initializeItems(){this.items=["Obra1 - 1234","Obra2 - 4321","Obra3 - 7894"]}ngOnInit(){this.load()}getItems(t){const e=t.target.value;this.items=this.obras,e&&""!==e.trim()?(this.isItemAvailable=!0,this.items=this.items.filter(t=>(console.log(t),t.DESCRIPCION.toLowerCase().indexOf(e.toLowerCase())>-1||t.OBRA.toLowerCase().indexOf(e.toLowerCase())>-1))):this.isItemAvailable=!1}getMachines(t){const e=t.target.value;this.itemsMachine=this.maquinas,e&&""!==e.trim()?(this.isMachineAvailable=!0,this.itemsMachine=this.itemsMachine.filter(t=>(console.log(t),t.NOMBRE.toLowerCase().indexOf(e.toLowerCase())>-1||t.COD_MAQUINA.toLowerCase().indexOf(e.toLowerCase())>-1))):this.isMachineAvailable=!1}obraSelected(t){this.obra=t.DESCRIPCION,this.obra_id=t.OBRA,this.isItemAvailable=!1,this.http.get(l.a.API+"/empresa/"+t.EMPRESA).subscribe(t=>{this.empresa=t,this.empresa=JSON.parse(this.empresa),this.empresa=this.empresa[0]}),this.http.get(l.a.API+"/capitulo/"+t.OBRA).subscribe(t=>{this.capitulos=t,this.capitulos=JSON.parse(this.capitulos),this.capitulo=""})}maquinaSelected(t){this.maquina=t.COD_MAQUINA,this.isMachineAvailable=!1}load(){return Object(r.a)(this,void 0,void 0,(function*(){let t=JSON.parse(localStorage.getItem("identity"));if(null!=t){this.identity=JSON.parse(t),console.log(this.identity);try{this.http.get(l.a.API+"/"+this.identity[0].EMPRESA).subscribe(t=>Object(r.a)(this,void 0,void 0,(function*(){this.obras=t,this.obras=JSON.parse(this.obras),this.http.get(l.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe(t=>{this.total=0,this.tareas=t,this.tareas=JSON.parse(this.tareas);for(let e=0;e<this.tareas.length;e++)this.tareas[e].CANTIDAD=parseFloat(this.tareas[e].CANTIDAD).toFixed(2),this.total=(parseFloat(this.tareas[e].CANTIDAD)+parseFloat(this.total||0)).toFixed(1);this.http.get(l.a.API+"/maquinas").subscribe(t=>{this.maquinas=t,this.maquinas=JSON.parse(this.maquinas),console.log(this.maquinas)})},t=>Object(r.a)(this,void 0,void 0,(function*(){this.load()})))})),t=>Object(r.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al cargar los datos.",buttons:[{text:"Ok",role:"cancel",handler:()=>{this.load()}}]});yield t.present()})))}catch(e){console.log(e)}}else this.router.navigateByUrl("/login")}))}save(){return Object(r.a)(this,void 0,void 0,(function*(){if(null!=this.empresa&&null!=this.obra_id&&null!=this.identity[0]&&null!=this.numHours&&null!=this.observations){let t={empresa:this.empresa.EMPRESA,obra:this.obra_id,fecha:this.myDate.slice(0,10),codigo:this.identity[0].COD_PERSONAL,descripcion:this.observations,cantidad:this.numHours,tipo:this.tipo,codigo_maquina:this.maquina,capitulo:this.capitulo};console.log(t);let e=this.loading.create({message:"Por favor espere..."});(yield e).present();let i=(new c.c).set("Content-Type","application/json").set("Accept","*/*");yield this.http.post(l.a.API+"/save/",t,{headers:i}).subscribe(t=>Object(r.a)(this,void 0,void 0,(function*(){yield this.http.get(l.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe(t=>{this.total=0,this.tareas=t,this.tareas=JSON.parse(this.tareas);for(let e=0;e<this.tareas.length;e++)this.tareas[e].CANTIDAD=parseFloat(this.tareas[e].CANTIDAD).toFixed(2),this.total=(parseFloat(this.tareas[e].CANTIDAD)+parseFloat(this.total||0)).toFixed(1)}),this.observations="",this.maquina="",this.capitulo="",this.numHours=0,this.obra=null,(yield e).dismiss()})),t=>Object(r.a)(this,void 0,void 0,(function*(){const t=yield this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al enviar tu trabajo.",buttons:["OK"]});(yield e).dismiss(),yield t.present()})))}else{console.log(this.empresa,this.obra_id,this.identity[0],this.numHours);const t=yield this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Por favor rellene el formulario .",buttons:["OK"]});yield t.present()}}))}salir(){window.localStorage.removeItem("identity"),this.navCtrl.navigateRoot("/login")}delete(t){this.http.delete(l.a.API+"/delete/"+t.LINEA+"/"+t.OBRA+"/"+this.identity[0].COD_PERSONAL).subscribe(t=>Object(r.a)(this,void 0,void 0,(function*(){yield this.http.get(l.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe(t=>{this.total=0,this.tareas=t,this.tareas=JSON.parse(this.tareas);for(let e=0;e<this.tareas.length;e++)this.tareas[e].CANTIDAD=parseFloat(this.tareas[e].CANTIDAD).toFixed(2),this.total=(parseFloat(this.tareas[e].CANTIDAD)+parseFloat(this.total||0)).toFixed(1);console.log(this.tareas)})})))}}return t.\u0275fac=function(e){return new(e||t)(b.Ib(n.F),b.Ib(n.E),b.Ib(s.g),b.Ib(n.a),b.Ib(c.a))},t.\u0275cmp=b.Cb({type:t,selectors:[["app-tab1"]],decls:52,vars:18,consts:[[3,"translucent"],[4,"ngIf"],["slot","end"],[3,"fullscreen"],["lines","full"],["position","stacked"],["type","text","debounce","600","name","obra","placeholder","Buscar obra",3,"ngModel","ngModelChange","ionInput"],["position","floating"],["placeholder","Empresa de la obra","name","empresa","type","text",3,"ngModel","readonly","ngModelChange",4,"ngIf"],["name","numhours","pattern","^[1-9]{1,3}$|^[0-9]{1,3}\\.[0-9]{1,3}$","clearOnEdit","true","inputmode","numeric","min","0","type","number","required","",3,"ngModel","ngModelChange"],["name","type","okText","Okay","cancelText","Cancelar",3,"value","ngModel","ngModelChange"],["value","M"],["value","P"],["value","X"],["lines","none",4,"ngIf"],["lines","full",4,"ngIf"],["name","observations","placeholder","Tus observaciones...",3,"ngModel","ngModelChange"],["name","time","displayFormat","DD/MM/YYYY","pickerFormat","DD/MM/YYYY",3,"ngModel","max","ngModelChange","maxChange"],["type","button","color","danger","expand","block",3,"click"],["type","submit","color","success","expand","block",3,"disabled","click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["placeholder","Empresa de la obra","name","empresa","type","text",3,"ngModel","readonly","ngModelChange"],["lines","none"],["debounce","600","name","maquina","clearOnEdit","true","required","",3,"ngModel","ngModelChange","ionInput"],["interface","action-sheet","name","cap",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[4,"ngFor","ngForOf"],["color","danger",3,"click"],["name","trash"]],template:function(t,e){1&t&&(b.Lb(0,"ion-header",0),b.Lb(1,"ion-toolbar"),b.nc(2,h,2,1,"ion-title",1),b.Lb(3,"h4",2),b.pc(4),b.Kb(),b.Kb(),b.Kb(),b.Lb(5,"ion-content",3),b.Lb(6,"form"),b.Lb(7,"ion-item",4),b.Lb(8,"ion-label",5),b.pc(9,"Obra"),b.Kb(),b.Lb(10,"ion-searchbar",6),b.Tb("ngModelChange",(function(t){return e.obra=t}))("ionInput",(function(t){return e.getItems(t)})),b.Kb(),b.nc(11,d,2,1,"ion-list",1),b.Kb(),b.Lb(12,"ion-item",4),b.Lb(13,"ion-label",7),b.pc(14,"Empresa"),b.Kb(),b.nc(15,p,1,2,"ion-input",8),b.Kb(),b.Lb(16,"ion-item",4),b.Lb(17,"ion-label",7),b.pc(18,"Horas"),b.Kb(),b.Lb(19,"ion-input",9),b.Tb("ngModelChange",(function(t){return e.numHours=t})),b.Kb(),b.Kb(),b.Lb(20,"ion-item",4),b.Lb(21,"ion-label",7),b.pc(22,"Tipo"),b.Kb(),b.Lb(23,"ion-select",10),b.Tb("ngModelChange",(function(t){return e.tipo=t})),b.Lb(24,"ion-select-option",11),b.pc(25,"Maquina"),b.Kb(),b.Lb(26,"ion-select-option",12),b.pc(27,"Persona"),b.Kb(),b.Lb(28,"ion-select-option",13),b.pc(29,"Mixto"),b.Kb(),b.Kb(),b.Kb(),b.nc(30,f,5,2,"ion-item",14),b.nc(31,O,5,2,"ion-item",15),b.Lb(32,"ion-item",4),b.Lb(33,"ion-label",7),b.pc(34,"Observaciones"),b.Kb(),b.Lb(35,"ion-textarea",16),b.Tb("ngModelChange",(function(t){return e.observations=t})),b.Kb(),b.Kb(),b.Lb(36,"ion-item",4),b.Lb(37,"ion-label",7),b.pc(38,"Fecha"),b.Kb(),b.Lb(39,"ion-datetime",17),b.Tb("ngModelChange",(function(t){return e.myDate=t}))("maxChange",(function(t){return e.maxDate=t})),b.Kb(),b.Kb(),b.Lb(40,"ion-row"),b.Lb(41,"ion-col"),b.Lb(42,"ion-button",18),b.Tb("click",(function(){return e.salir()})),b.pc(43,"Salir"),b.Kb(),b.Kb(),b.Lb(44,"ion-col"),b.Lb(45,"ion-button",19),b.Tb("click",(function(){return e.save()})),b.pc(46,"Aceptar"),b.Kb(),b.Kb(),b.Kb(),b.Kb(),b.Lb(47,"ion-header",0),b.Lb(48,"ion-toolbar"),b.Lb(49,"ion-title"),b.pc(50,"Tus obras"),b.Kb(),b.Kb(),b.Kb(),b.nc(51,I,2,1,"div",1),b.Kb()),2&t&&(b.bc("translucent",!0),b.xb(2),b.bc("ngIf",e.identity),b.xb(2),b.rc("",e.total," h"),b.xb(1),b.bc("fullscreen",!0),b.xb(5),b.bc("ngModel",e.obra),b.xb(1),b.bc("ngIf",e.isItemAvailable),b.xb(4),b.bc("ngIf",e.empresa),b.xb(4),b.bc("ngModel",e.numHours),b.xb(4),b.bc("value",e.tipo)("ngModel",e.tipo),b.xb(7),b.bc("ngIf","P"!=e.tipo),b.xb(1),b.bc("ngIf",e.capitulos),b.xb(4),b.bc("ngModel",e.observations),b.xb(4),b.bc("ngModel",e.myDate)("max",e.maxDate),b.xb(6),b.bc("disabled",!e.obra||!e.numHours||e.numHours<=0||"-"===e.numHours||""===e.capitulo||"M"==e.tipo&&""===e.maquina||"X"==e.tipo&&""===e.maquina),b.xb(2),b.bc("translucent",!0),b.xb(4),b.bc("ngIf",e.tareas))},directives:[n.i,n.B,o.j,n.g,a.j,a.e,a.f,n.l,n.p,n.t,n.J,a.d,a.g,n.k,n.G,a.h,a.i,n.u,n.I,n.v,n.z,n.h,n.s,n.f,n.c,n.A,n.q,o.i,n.o,n.n,n.m,n.j],styles:["h4[_ngcontent-%COMP%]{margin-right:1rem}ion-label[_ngcontent-%COMP%]{opacity:1!important}"]}),t})()}];let A=(()=>{class t{}return t.\u0275mod=b.Gb({type:t}),t.\u0275inj=b.Fb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(L)],s.i]}),t})(),v=(()=>{class t{}return t.\u0275mod=b.Gb({type:t}),t.\u0275inj=b.Fb({factory:function(e){return new(e||t)},imports:[[n.C,o.b,a.a,A]]}),t})()}}]);