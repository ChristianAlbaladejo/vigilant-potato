!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{tmrb:function(n,i,o){"use strict";o.r(i),o.d(i,"Tab1PageModule",(function(){return R}));var a=o("TEn/"),r=o("ofXK"),s=o("3Pt+"),c=o("tyNb"),u=o("mrSG"),b=o("tk/3"),l=o("AytR"),h=o("gcOT"),p=o("fXoL"),m=o("ej43");function f(e,t){if(1&e&&(p.Lb(0,"ion-title"),p.pc(1),p.Kb()),2&e){var n=p.Vb();p.xb(1),p.rc(" Hola ",n.identity[0].NOMBRE," ")}}function d(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",27),p.Tb("click",(function(){p.jc(n);var e=t.$implicit;return p.Vb(2).obraSelected(e)})),p.pc(1),p.Kb()}if(2&e){var i=t.$implicit;p.xb(1),p.sc("",i.DESCRIPCION," - ",i.OBRA,"")}}function g(e,t){if(1&e&&(p.Lb(0,"ion-list"),p.nc(1,d,2,2,"ion-item",26),p.Kb()),2&e){var n=p.Vb();p.xb(1),p.bc("ngForOf",n.items)}}function v(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",27),p.Tb("click",(function(){p.jc(n);var e=t.$implicit;return p.Vb(3).maquinaSelected(e)})),p.pc(1),p.Kb()}if(2&e){var i=t.$implicit;p.xb(1),p.sc("",i.NOMBRE," - ",i.COD_MAQUINA," ")}}function x(e,t){if(1&e&&(p.Lb(0,"ion-list"),p.nc(1,v,2,2,"ion-item",26),p.Kb()),2&e){var n=p.Vb(2);p.xb(1),p.bc("ngForOf",n.itemsMachine)}}function O(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",28),p.Lb(1,"ion-label",7),p.pc(2,"Maquina"),p.Kb(),p.Lb(3,"ion-input",29),p.Tb("ngModelChange",(function(e){return p.jc(n),p.Vb().maquina=e}))("ionFocus",(function(){return p.jc(n),p.Vb().checkMaquinaFocus()}))("ionInput",(function(e){return p.jc(n),p.Vb().getMachines(e)})),p.Kb(),p.nc(4,x,2,1,"ion-list",1),p.Kb()}if(2&e){var i=p.Vb();p.xb(3),p.bc("ngModel",i.maquina),p.xb(1),p.bc("ngIf",i.isMachineAvailable)}}function M(e,t){if(1&e&&(p.Lb(0,"ion-select-option",32),p.pc(1),p.Kb()),2&e){var n=t.$implicit;p.bc("value",n.COD_INTERNO),p.xb(1),p.qc(n.NOMBRE)}}function L(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",4),p.Lb(1,"ion-label",7),p.pc(2,"Precios"),p.Kb(),p.Lb(3,"ion-select",30),p.Tb("ngModelChange",(function(e){return p.jc(n),p.Vb().precio=e})),p.nc(4,M,2,2,"ion-select-option",31),p.Kb(),p.Kb()}if(2&e){var i=p.Vb();p.xb(3),p.bc("ngModel",i.precio),p.xb(1),p.bc("ngForOf",i.precios)}}function C(e,t){if(1&e&&(p.Lb(0,"ion-select-option",32),p.pc(1),p.Kb()),2&e){var n=t.$implicit;p.bc("value",n.CAPITULO),p.xb(1),p.qc(n.NOMBRE)}}function I(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",4),p.Lb(1,"ion-label",7),p.pc(2,"Cap\xedtulo"),p.Kb(),p.Lb(3,"ion-select",33),p.Tb("ngModelChange",(function(e){return p.jc(n),p.Vb().capitulo=e})),p.nc(4,C,2,2,"ion-select-option",31),p.Kb(),p.Kb()}if(2&e){var i=p.Vb();p.xb(3),p.bc("ngModel",i.capitulo),p.xb(1),p.bc("ngForOf",i.capitulos)}}function y(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item-sliding"),p.Lb(1,"ion-item"),p.Lb(2,"ion-label"),p.pc(3),p.Kb(),p.Kb(),p.Lb(4,"ion-item-options"),p.Lb(5,"ion-item-option",35),p.Tb("click",(function(){p.jc(n);var e=t.$implicit;return p.Vb(2).delete(e)})),p.Jb(6,"ion-icon",36),p.Kb(),p.Kb(),p.Kb()}if(2&e){var i=t.$implicit;p.xb(3),p.sc(" ",i.DESCRIPCION,", ",i.CANTIDAD," h ")}}function A(e,t){if(1&e&&(p.Lb(0,"div"),p.nc(1,y,7,2,"ion-item-sliding",34),p.Kb()),2&e){var n=p.Vb();p.xb(1),p.bc("ngForOf",n.tareas)}}var k,K,w,D=h.a.Storage,P=[{path:"",component:(k=function(){function n(t,i,o,a,r,s){e(this,n),this.navCtrl=t,this.loading=i,this.router=o,this.alert=a,this.authService=r,this.http=s,this.myDate=(new Date).toISOString(),this.maxDate=(new Date).toISOString(),this.observations="",this.numHours=0,this.isItemAvailable=!1,this.isMachineAvailable=!1,this.showPrecios=!1,this.items=[],this.itemsMachine=[],this.capitulo="",this.tipo="P",this.maquina="",this.load()}var i,o,a;return i=n,(o=[{key:"initializeItems",value:function(){this.items=["Obra1 - 1234","Obra2 - 4321","Obra3 - 7894"]}},{key:"ngOnInit",value:function(){this.load()}},{key:"getItems",value:function(e){var t=e.target.value;this.items=this.obras,t&&""!==t.trim()?(this.isItemAvailable=!0,this.items=this.items.filter((function(e){return console.log(e),e.DESCRIPCION.toLowerCase().indexOf(t.toLowerCase())>-1||e.OBRA.toLowerCase().indexOf(t.toLowerCase())>-1}))):this.isItemAvailable=!1}},{key:"getMachines",value:function(e){var t=e.target.value;this.itemsMachine=this.maquinas,t&&""!==t.trim()?(this.isMachineAvailable=!0,this.itemsMachine=this.itemsMachine.filter((function(e){return console.log(e),e.NOMBRE.toLowerCase().indexOf(t.toLowerCase())>-1||e.COD_MAQUINA.toLowerCase().indexOf(t.toLowerCase())>-1}))):this.isMachineAvailable=!1}},{key:"obraSelected",value:function(e){var t=this;this.obra=e.DESCRIPCION,this.obra_id=e.OBRA,this.isItemAvailable=!1,this.http.get(l.a.API+"/empresa/"+e.EMPRESA).subscribe((function(e){t.empresa=e,t.empresa=JSON.parse(t.empresa),t.empresa=t.empresa[0]})),this.http.get(l.a.API+"/capitulo/"+e.OBRA).subscribe((function(e){t.capitulos=e,t.capitulos=JSON.parse(t.capitulos),t.capitulo=""}))}},{key:"maquinaSelected",value:function(e){var t=this;this.maquina=e.COD_MAQUINA,this.isMachineAvailable=!1,this.http.get(l.a.API+"/precios/"+e.COD_MAQUINA).subscribe((function(e){t.precios=e,t.precios=JSON.parse(t.precios),console.log(t.precios),1==t.precios.length?(t.precio=t.precios[0].COD_INTERNO,t.showPrecios=!1):t.showPrecios=!0}))}},{key:"load",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.loading.create({message:"Por favor espere..."}),e.next=3,t;case 3:return e.sent.present(),e.next=6,D.get({key:"my-token"});case 6:if(n=e.sent,n=JSON.parse(n.value),console.log(n),null==n){e.next=24;break}return this.identity=n,console.log(this.identity),e.prev=9,this.http.get(l.a.API+"/"+this.identity[0].EMPRESA).subscribe((function(e){return Object(u.a)(i,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.obras=e,this.obras=JSON.parse(this.obras),this.http.get(l.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){n.total=0,n.tareas=e,n.tareas=JSON.parse(n.tareas);for(var t=0;t<n.tareas.length;t++)n.tareas[t].CANTIDAD=parseFloat(n.tareas[t].CANTIDAD).toFixed(2),n.total=(parseFloat(n.tareas[t].CANTIDAD)+parseFloat(n.total||0)).toFixed(1);n.http.get(l.a.API+"/maquinas").subscribe((function(e){n.maquinas=e,n.maquinas=JSON.parse(n.maquinas),console.log(n.maquinas)}))}),(function(e){return Object(u.a)(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.load();case 1:case"end":return e.stop()}}),e,this)})))}));case 1:case"end":return t.stop()}}),t,this)})))}),(function(e){return Object(u.a)(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al cargar los datos.",buttons:[{text:"Ok",role:"cancel",handler:function(){n.load()}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}}),e,this)})))})),e.next=13,t;case 13:e.sent.dismiss(),e.next=22;break;case 16:return e.prev=16,e.t0=e.catch(9),e.next=20,t;case 20:e.sent.dismiss(),this.salir();case 22:e.next=28;break;case 24:return e.next=26,t;case 26:e.sent.dismiss(),this.salir();case 28:case"end":return e.stop()}}),e,this,[[9,16]])})))}},{key:"save",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.empresa||null==this.obra_id||null==this.identity[0]||null==this.numHours||null==this.observations){e.next=10;break}return t={empresa:this.empresa.EMPRESA,obra:this.obra_id,fecha:this.myDate.slice(0,10),codigo:this.identity[0].COD_PERSONAL,descripcion:this.observations,cantidad:this.numHours,tipo:this.tipo,codigo_maquina:this.maquina,capitulo:this.capitulo,precio_maquina:this.precio},n=this.loading.create({message:"Por favor espere..."}),e.next=4,n;case 4:return e.sent.present(),i=(new b.c).set("Content-Type","application/json").set("Accept","*/*"),e.next=8,this.http.post(l.a.API+"/save/",t,{headers:i}).subscribe((function(e){return Object(u.a)(a,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get(l.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){t.total=0,t.tareas=e,t.tareas=JSON.parse(t.tareas);for(var n=0;n<t.tareas.length;n++)t.tareas[n].CANTIDAD=parseFloat(t.tareas[n].CANTIDAD).toFixed(2),t.total=(parseFloat(t.tareas[n].CANTIDAD)+parseFloat(t.total||0)).toFixed(1)}));case 2:return this.observations="",this.maquina="",this.capitulo="",this.numHours=0,this.obra=null,this.showPrecios=!1,e.next=10,n;case 10:e.sent.dismiss();case 11:case"end":return e.stop()}}),e,this)})))}),(function(e){return Object(u.a)(a,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al enviar tu trabajo.",buttons:["OK"]});case 2:return t=e.sent,e.next=5,n;case 5:return e.sent.dismiss(),e.next=8,t.present();case 8:case"end":return e.stop()}}),e,this)})))}));case 8:e.next=16;break;case 10:return console.log(this.empresa,this.obra_id,this.identity[0],this.numHours),e.next=13,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Por favor rellene el formulario .",buttons:["OK"]});case 13:return o=e.sent,e.next=16,o.present();case 16:case"end":return e.stop()}}),e,this)})))}},{key:"salir",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authService.logout();case 2:this.router.navigateByUrl("/",{replaceUrl:!0});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"checkFocus",value:function(){this.isItemAvailable=!0,this.items=this.obras}},{key:"checkMaquinaFocus",value:function(){this.isMachineAvailable=!0,this.itemsMachine=this.maquinas}},{key:"incrementQty",value:function(){this.numHours+=1}},{key:"byPassValue",value:function(){this.numHours<0&&(this.numHours=0),console.log(this.numHours)}},{key:"decrementQty",value:function(){this.numHours<=0?this.numHours=0:this.numHours-=1}},{key:"delete",value:function(e){var t=this;this.http.delete(l.a.API+"/delete/"+e.LINEA+"/"+e.OBRA+"/"+this.identity[0].COD_PERSONAL).subscribe((function(e){return Object(u.a)(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get(l.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){t.total=0,t.tareas=e,t.tareas=JSON.parse(t.tareas);for(var n=0;n<t.tareas.length;n++)t.tareas[n].CANTIDAD=parseFloat(t.tareas[n].CANTIDAD).toFixed(2),t.total=(parseFloat(t.tareas[n].CANTIDAD)+parseFloat(t.total||0)).toFixed(1);console.log(t.tareas)}));case 2:case"end":return e.stop()}}),e,this)})))}))}}])&&t(i.prototype,o),a&&t(i,a),n}(),k.\u0275fac=function(e){return new(e||k)(p.Ib(a.H),p.Ib(a.F),p.Ib(c.g),p.Ib(a.a),p.Ib(m.a),p.Ib(b.a))},k.\u0275cmp=p.Cb({type:k,selectors:[["app-tab1"]],decls:58,vars:18,consts:[[3,"translucent"],[4,"ngIf"],["slot","end"],[3,"fullscreen"],["lines","full"],["position","stacked"],["type","text","debounce","600","name","obra","placeholder","Buscar obra",3,"ngModel","ngModelChange","ionInput","ionFocus"],["position","floating"],["no-padding",""],["no-padding","","justify-content-start","","align-items-start",""],["size","auto","ion-item","","no-lines","","no-padding","","text-center","","col-2",""],["color","primary",3,"click"],["name","remove-outline"],["ion-item","","no-lines","","no-padding","","text-center","","col-2",""],["name","numhours","pattern","^[1-9]{1,3}$|^[0-9]{1,3}\\.[0-9]{1,3}$","clearOnEdit","true","inputmode","numeric","min","0","type","number","required","",3,"ngModel","ngModelChange","ionInput"],["name","add-outline"],["name","type","okText","Okay","cancelText","Cancelar",3,"value","ngModel","ngModelChange"],["value","M"],["value","P"],["value","X"],["lines","none",4,"ngIf"],["lines","full",4,"ngIf"],["name","observations","placeholder","Tus observaciones...",3,"ngModel","ngModelChange"],["name","time","displayFormat","DD/MM/YYYY","pickerFormat","DD/MM/YYYY",3,"ngModel","max","ngModelChange","maxChange"],["type","button","color","danger","expand","block",3,"click"],["type","submit","color","success","expand","block",3,"disabled","click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["lines","none"],["debounce","600","name","maquina","clearOnEdit","true","required","",3,"ngModel","ngModelChange","ionFocus","ionInput"],["name","cap",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["interface","action-sheet","name","cap",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["color","danger",3,"click"],["name","trash"]],template:function(e,t){1&e&&(p.Lb(0,"ion-header",0),p.Lb(1,"ion-toolbar"),p.nc(2,f,2,1,"ion-title",1),p.Lb(3,"h4",2),p.pc(4),p.Kb(),p.Kb(),p.Kb(),p.Lb(5,"ion-content",3),p.Lb(6,"form"),p.Lb(7,"ion-item",4),p.Lb(8,"ion-label",5),p.pc(9,"Obra"),p.Kb(),p.Lb(10,"ion-searchbar",6),p.Tb("ngModelChange",(function(e){return t.obra=e}))("ionInput",(function(e){return t.getItems(e)}))("ionFocus",(function(){return t.checkFocus()})),p.Kb(),p.nc(11,g,2,1,"ion-list",1),p.Kb(),p.Lb(12,"ion-item",4),p.Lb(13,"ion-label",7),p.pc(14,"Horas"),p.Kb(),p.Lb(15,"ion-grid",8),p.Lb(16,"ion-row",9),p.Lb(17,"ion-col",10),p.Lb(18,"ion-fab-button",11),p.Tb("click",(function(){return t.decrementQty()})),p.Jb(19,"ion-icon",12),p.Kb(),p.Kb(),p.Lb(20,"ion-col",13),p.Lb(21,"ion-input",14),p.Tb("ngModelChange",(function(e){return t.numHours=e}))("ionInput",(function(){return t.byPassValue()})),p.Kb(),p.Kb(),p.Lb(22,"ion-col",10),p.Lb(23,"ion-fab-button",11),p.Tb("click",(function(){return t.incrementQty()})),p.Jb(24,"ion-icon",15),p.Kb(),p.Kb(),p.Kb(),p.Kb(),p.Kb(),p.Lb(25,"ion-item",4),p.Lb(26,"ion-label",7),p.pc(27,"Tipo"),p.Kb(),p.Lb(28,"ion-select",16),p.Tb("ngModelChange",(function(e){return t.tipo=e})),p.Lb(29,"ion-select-option",17),p.pc(30,"Maquina"),p.Kb(),p.Lb(31,"ion-select-option",18),p.pc(32,"Persona"),p.Kb(),p.Lb(33,"ion-select-option",19),p.pc(34,"Mixto"),p.Kb(),p.Kb(),p.Kb(),p.nc(35,O,5,2,"ion-item",20),p.nc(36,L,5,2,"ion-item",21),p.nc(37,I,5,2,"ion-item",21),p.Lb(38,"ion-item",4),p.Lb(39,"ion-label",7),p.pc(40,"Observaciones"),p.Kb(),p.Lb(41,"ion-textarea",22),p.Tb("ngModelChange",(function(e){return t.observations=e})),p.Kb(),p.Kb(),p.Lb(42,"ion-item",4),p.Lb(43,"ion-label",7),p.pc(44,"Fecha"),p.Kb(),p.Lb(45,"ion-datetime",23),p.Tb("ngModelChange",(function(e){return t.myDate=e}))("maxChange",(function(e){return t.maxDate=e})),p.Kb(),p.Kb(),p.Lb(46,"ion-row"),p.Lb(47,"ion-col"),p.Lb(48,"ion-button",24),p.Tb("click",(function(){return t.salir()})),p.pc(49,"Salir"),p.Kb(),p.Kb(),p.Lb(50,"ion-col"),p.Lb(51,"ion-button",25),p.Tb("click",(function(){return t.save()})),p.pc(52," Aceptar"),p.Kb(),p.Kb(),p.Kb(),p.Kb(),p.Lb(53,"ion-header",0),p.Lb(54,"ion-toolbar"),p.Lb(55,"ion-title"),p.pc(56,"Tus obras"),p.Kb(),p.Kb(),p.Kb(),p.nc(57,A,2,1,"div",1),p.Kb()),2&e&&(p.bc("translucent",!0),p.xb(2),p.bc("ngIf",t.identity),p.xb(2),p.rc("",t.total," h"),p.xb(1),p.bc("fullscreen",!0),p.xb(5),p.bc("ngModel",t.obra),p.xb(1),p.bc("ngIf",t.isItemAvailable),p.xb(10),p.bc("ngModel",t.numHours),p.xb(7),p.bc("value",t.tipo)("ngModel",t.tipo),p.xb(7),p.bc("ngIf","P"!=t.tipo),p.xb(1),p.bc("ngIf",t.showPrecios),p.xb(1),p.bc("ngIf",t.capitulos),p.xb(4),p.bc("ngModel",t.observations),p.xb(4),p.bc("ngModel",t.myDate)("max",t.maxDate),p.xb(6),p.bc("disabled",!t.obra||!t.numHours||t.numHours<=0||""===t.capitulo||"M"==t.tipo&&""===t.maquina&&""===t.precio||"X"==t.tipo&&""===t.maquina&&""===t.precio),p.xb(2),p.bc("translucent",!0),p.xb(4),p.bc("ngIf",t.tareas))},directives:[a.j,a.C,r.j,a.f,s.n,s.h,s.i,a.m,a.q,a.u,a.L,s.g,s.j,a.i,a.t,a.e,a.h,a.k,a.l,a.I,s.k,s.m,a.v,a.K,a.w,a.A,a.g,a.c,a.B,a.r,r.i,a.p,a.o,a.n],styles:["h4[_ngcontent-%COMP%]{margin-right:1rem}ion-label[_ngcontent-%COMP%]{opacity:1!important}ion-fab-button[_ngcontent-%COMP%]{width:40px;height:40px}ion-row[_ngcontent-%COMP%]{margin-top:.5rem}"]}),k)}],N=((w=function t(){e(this,t)}).\u0275mod=p.Gb({type:w}),w.\u0275inj=p.Fb({factory:function(e){return new(e||w)},imports:[[c.i.forChild(P)],c.i]}),w),R=((K=function t(){e(this,t)}).\u0275mod=p.Gb({type:K}),K.\u0275inj=p.Fb({factory:function(e){return new(e||K)},imports:[[a.D,r.b,s.d,N]]}),K)}}])}();