!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{tmrb:function(n,i,a){"use strict";a.r(i),a.d(i,"Tab1PageModule",(function(){return k}));var o=a("TEn/"),r=a("ofXK"),s=a("3Pt+"),c=a("tyNb"),b=a("mrSG"),l=a("tk/3"),u=a("AytR"),p=a("fXoL");function h(e,t){if(1&e&&(p.Lb(0,"ion-title"),p.pc(1),p.Kb()),2&e){var n=p.Vb();p.xb(1),p.rc(" Hola ",n.identity[0].NOMBRE," ")}}function m(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",21),p.Tb("click",(function(){p.jc(n);var e=t.$implicit;return p.Vb(2).obraSelected(e)})),p.pc(1),p.Kb()}if(2&e){var i=t.$implicit;p.xb(1),p.sc("",i.DESCRIPCION," - ",i.OBRA,"")}}function d(e,t){if(1&e&&(p.Lb(0,"ion-list"),p.nc(1,m,2,2,"ion-item",20),p.Kb()),2&e){var n=p.Vb();p.xb(1),p.bc("ngForOf",n.items)}}function f(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-input",22),p.Tb("ngModelChange",(function(e){return p.jc(n),p.Vb().empresa.DESCRIPCION=e})),p.Kb()}if(2&e){var i=p.Vb();p.bc("ngModel",i.empresa.DESCRIPCION)("readonly",!0)}}function g(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",21),p.Tb("click",(function(){p.jc(n);var e=t.$implicit;return p.Vb(3).maquinaSelected(e)})),p.pc(1),p.Kb()}if(2&e){var i=t.$implicit;p.xb(1),p.sc("",i.NOMBRE," - ",i.COD_MAQUINA,"")}}function v(e,t){if(1&e&&(p.Lb(0,"ion-list"),p.nc(1,g,2,2,"ion-item",20),p.Kb()),2&e){var n=p.Vb(2);p.xb(1),p.bc("ngForOf",n.itemsMachine)}}function x(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",23),p.Lb(1,"ion-label",7),p.pc(2,"Maquina"),p.Kb(),p.Lb(3,"ion-input",24),p.Tb("ngModelChange",(function(e){return p.jc(n),p.Vb().maquina=e}))("ionInput",(function(e){return p.jc(n),p.Vb().getMachines(e)})),p.Kb(),p.nc(4,v,2,1,"ion-list",1),p.Kb()}if(2&e){var i=p.Vb();p.xb(3),p.bc("ngModel",i.maquina),p.xb(1),p.bc("ngIf",i.isMachineAvailable)}}function M(e,t){if(1&e&&(p.Lb(0,"ion-select-option",27),p.pc(1),p.Kb()),2&e){var n=t.$implicit;p.bc("value",n.CAPITULO),p.xb(1),p.qc(n.NOMBRE)}}function O(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item",4),p.Lb(1,"ion-label",7),p.pc(2,"Cap\xedtulo"),p.Kb(),p.Lb(3,"ion-select",25),p.Tb("ngModelChange",(function(e){return p.jc(n),p.Vb().capitulo=e})),p.nc(4,M,2,2,"ion-select-option",26),p.Kb(),p.Kb()}if(2&e){var i=p.Vb();p.xb(3),p.bc("ngModel",i.capitulo),p.xb(1),p.bc("ngForOf",i.capitulos)}}function C(e,t){if(1&e){var n=p.Mb();p.Lb(0,"ion-item-sliding"),p.Lb(1,"ion-item"),p.Lb(2,"ion-label"),p.pc(3),p.Kb(),p.Kb(),p.Lb(4,"ion-item-options"),p.Lb(5,"ion-item-option",29),p.Tb("click",(function(){p.jc(n);var e=t.$implicit;return p.Vb(2).delete(e)})),p.Jb(6,"ion-icon",30),p.Kb(),p.Kb(),p.Kb()}if(2&e){var i=t.$implicit;p.xb(3),p.sc(" ",i.DESCRIPCION,", ",i.CANTIDAD," h ")}}function I(e,t){if(1&e&&(p.Lb(0,"div"),p.nc(1,C,7,2,"ion-item-sliding",28),p.Kb()),2&e){var n=p.Vb();p.xb(1),p.bc("ngForOf",n.tareas)}}var L,A,y,K=[{path:"",component:(L=function(){function n(t,i,a,o,r){e(this,n),this.navCtrl=t,this.loading=i,this.router=a,this.alert=o,this.http=r,this.myDate=(new Date).toISOString(),this.maxDate=(new Date).toISOString(),this.observations="",this.isItemAvailable=!1,this.isMachineAvailable=!1,this.items=[],this.itemsMachine=[],this.capitulo="",this.tipo="P",this.maquina="",this.load()}var i,a,o;return i=n,(a=[{key:"initializeItems",value:function(){this.items=["Obra1 - 1234","Obra2 - 4321","Obra3 - 7894"]}},{key:"ngOnInit",value:function(){this.load()}},{key:"getItems",value:function(e){var t=e.target.value;this.items=this.obras,t&&""!==t.trim()?(this.isItemAvailable=!0,this.items=this.items.filter((function(e){return console.log(e),e.DESCRIPCION.toLowerCase().indexOf(t.toLowerCase())>-1||e.OBRA.toLowerCase().indexOf(t.toLowerCase())>-1}))):this.isItemAvailable=!1}},{key:"getMachines",value:function(e){var t=e.target.value;this.itemsMachine=this.maquinas,t&&""!==t.trim()?(this.isMachineAvailable=!0,this.itemsMachine=this.itemsMachine.filter((function(e){return console.log(e),e.NOMBRE.toLowerCase().indexOf(t.toLowerCase())>-1||e.COD_MAQUINA.toLowerCase().indexOf(t.toLowerCase())>-1}))):this.isMachineAvailable=!1}},{key:"obraSelected",value:function(e){var t=this;this.obra=e.DESCRIPCION,this.obra_id=e.OBRA,this.isItemAvailable=!1,this.http.get(u.a.API+"/empresa/"+e.EMPRESA).subscribe((function(e){t.empresa=e,t.empresa=JSON.parse(t.empresa),t.empresa=t.empresa[0]})),this.http.get(u.a.API+"/capitulo/"+e.OBRA).subscribe((function(e){t.capitulos=e,t.capitulos=JSON.parse(t.capitulos),t.capitulo=""}))}},{key:"maquinaSelected",value:function(e){this.maquina=e.COD_MAQUINA,this.isMachineAvailable=!1}},{key:"load",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(localStorage.getItem("identity")))){this.identity=JSON.parse(t),console.log(this.identity);try{this.http.get(u.a.API+"/"+this.identity[0].EMPRESA).subscribe((function(e){return Object(b.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.obras=e,this.obras=JSON.parse(this.obras),this.http.get(u.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){n.total=0,n.tareas=e,n.tareas=JSON.parse(n.tareas);for(var t=0;t<n.tareas.length;t++)n.tareas[t].CANTIDAD=parseFloat(n.tareas[t].CANTIDAD).toFixed(2),n.total=(parseFloat(n.tareas[t].CANTIDAD)+parseFloat(n.total||0)).toFixed(1);n.http.get(u.a.API+"/maquinas").subscribe((function(e){n.maquinas=e,n.maquinas=JSON.parse(n.maquinas),console.log(n.maquinas)}))}),(function(e){return Object(b.a)(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.load();case 1:case"end":return e.stop()}}),e,this)})))}));case 1:case"end":return t.stop()}}),t,this)})))}),(function(e){return Object(b.a)(n,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al cargar los datos.",buttons:[{text:"Ok",role:"cancel",handler:function(){n.load()}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}}),e,this)})))}))}catch(i){console.log(i)}}else this.router.navigateByUrl("/login");case 2:case"end":return e.stop()}}),e,this)})))}},{key:"save",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i,a,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.empresa||null==this.obra_id||null==this.identity[0]||null==this.numHours||null==this.observations){e.next=12;break}return t={empresa:this.empresa.EMPRESA,obra:this.obra_id,fecha:this.myDate.slice(0,10),codigo:this.identity[0].COD_PERSONAL,descripcion:this.observations,cantidad:this.numHours,tipo:this.tipo,codigo_maquina:this.maquina,capitulo:this.capitulo},console.log(t),n=this.loading.create({message:"Por favor espere..."}),e.next=6,n;case 6:return e.sent.present(),i=(new l.c).set("Content-Type","application/json").set("Accept","*/*"),e.next=10,this.http.post(u.a.API+"/save/",t,{headers:i}).subscribe((function(e){return Object(b.a)(o,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get(u.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){t.total=0,t.tareas=e,t.tareas=JSON.parse(t.tareas);for(var n=0;n<t.tareas.length;n++)t.tareas[n].CANTIDAD=parseFloat(t.tareas[n].CANTIDAD).toFixed(2),t.total=(parseFloat(t.tareas[n].CANTIDAD)+parseFloat(t.total||0)).toFixed(1)}));case 2:return this.observations="",this.maquina="",this.capitulo="",this.numHours=0,this.obra=null,e.next=9,n;case 9:e.sent.dismiss();case 10:case"end":return e.stop()}}),e,this)})))}),(function(e){return Object(b.a)(o,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al enviar tu trabajo.",buttons:["OK"]});case 2:return t=e.sent,e.next=5,n;case 5:return e.sent.dismiss(),e.next=8,t.present();case 8:case"end":return e.stop()}}),e,this)})))}));case 10:e.next=18;break;case 12:return console.log(this.empresa,this.obra_id,this.identity[0],this.numHours),e.next=15,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Por favor rellene el formulario .",buttons:["OK"]});case 15:return a=e.sent,e.next=18,a.present();case 18:case"end":return e.stop()}}),e,this)})))}},{key:"salir",value:function(){window.localStorage.removeItem("identity"),this.navCtrl.navigateRoot("/login")}},{key:"delete",value:function(e){var t=this;this.http.delete(u.a.API+"/delete/"+e.LINEA+"/"+e.OBRA+"/"+this.identity[0].COD_PERSONAL).subscribe((function(e){return Object(b.a)(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get(u.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){t.total=0,t.tareas=e,t.tareas=JSON.parse(t.tareas);for(var n=0;n<t.tareas.length;n++)t.tareas[n].CANTIDAD=parseFloat(t.tareas[n].CANTIDAD).toFixed(2),t.total=(parseFloat(t.tareas[n].CANTIDAD)+parseFloat(t.total||0)).toFixed(1);console.log(t.tareas)}));case 2:case"end":return e.stop()}}),e,this)})))}))}}])&&t(i.prototype,a),o&&t(i,o),n}(),L.\u0275fac=function(e){return new(e||L)(p.Ib(o.F),p.Ib(o.E),p.Ib(c.g),p.Ib(o.a),p.Ib(l.a))},L.\u0275cmp=p.Cb({type:L,selectors:[["app-tab1"]],decls:52,vars:18,consts:[[3,"translucent"],[4,"ngIf"],["slot","end"],[3,"fullscreen"],["lines","full"],["position","stacked"],["type","text","debounce","600","name","obra","placeholder","Buscar obra",3,"ngModel","ngModelChange","ionInput"],["position","floating"],["placeholder","Empresa de la obra","name","empresa","type","text",3,"ngModel","readonly","ngModelChange",4,"ngIf"],["name","numhours","pattern","^[1-9]{1,3}$|^[0-9]{1,3}\\.[0-9]{1,3}$","clearOnEdit","true","inputmode","numeric","min","0","type","number","required","",3,"ngModel","ngModelChange"],["name","type","okText","Okay","cancelText","Cancelar",3,"value","ngModel","ngModelChange"],["value","M"],["value","P"],["value","X"],["lines","none",4,"ngIf"],["lines","full",4,"ngIf"],["name","observations","placeholder","Tus observaciones...",3,"ngModel","ngModelChange"],["name","time","displayFormat","DD/MM/YYYY","pickerFormat","DD/MM/YYYY",3,"ngModel","max","ngModelChange","maxChange"],["type","button","color","danger","expand","block",3,"click"],["type","submit","color","success","expand","block",3,"disabled","click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["placeholder","Empresa de la obra","name","empresa","type","text",3,"ngModel","readonly","ngModelChange"],["lines","none"],["debounce","600","name","maquina","clearOnEdit","true","required","",3,"ngModel","ngModelChange","ionInput"],["interface","action-sheet","name","cap",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[4,"ngFor","ngForOf"],["color","danger",3,"click"],["name","trash"]],template:function(e,t){1&e&&(p.Lb(0,"ion-header",0),p.Lb(1,"ion-toolbar"),p.nc(2,h,2,1,"ion-title",1),p.Lb(3,"h4",2),p.pc(4),p.Kb(),p.Kb(),p.Kb(),p.Lb(5,"ion-content",3),p.Lb(6,"form"),p.Lb(7,"ion-item",4),p.Lb(8,"ion-label",5),p.pc(9,"Obra"),p.Kb(),p.Lb(10,"ion-searchbar",6),p.Tb("ngModelChange",(function(e){return t.obra=e}))("ionInput",(function(e){return t.getItems(e)})),p.Kb(),p.nc(11,d,2,1,"ion-list",1),p.Kb(),p.Lb(12,"ion-item",4),p.Lb(13,"ion-label",7),p.pc(14,"Empresa"),p.Kb(),p.nc(15,f,1,2,"ion-input",8),p.Kb(),p.Lb(16,"ion-item",4),p.Lb(17,"ion-label",7),p.pc(18,"Horas"),p.Kb(),p.Lb(19,"ion-input",9),p.Tb("ngModelChange",(function(e){return t.numHours=e})),p.Kb(),p.Kb(),p.Lb(20,"ion-item",4),p.Lb(21,"ion-label",7),p.pc(22,"Tipo"),p.Kb(),p.Lb(23,"ion-select",10),p.Tb("ngModelChange",(function(e){return t.tipo=e})),p.Lb(24,"ion-select-option",11),p.pc(25,"Maquina"),p.Kb(),p.Lb(26,"ion-select-option",12),p.pc(27,"Persona"),p.Kb(),p.Lb(28,"ion-select-option",13),p.pc(29,"Mixto"),p.Kb(),p.Kb(),p.Kb(),p.nc(30,x,5,2,"ion-item",14),p.nc(31,O,5,2,"ion-item",15),p.Lb(32,"ion-item",4),p.Lb(33,"ion-label",7),p.pc(34,"Observaciones"),p.Kb(),p.Lb(35,"ion-textarea",16),p.Tb("ngModelChange",(function(e){return t.observations=e})),p.Kb(),p.Kb(),p.Lb(36,"ion-item",4),p.Lb(37,"ion-label",7),p.pc(38,"Fecha"),p.Kb(),p.Lb(39,"ion-datetime",17),p.Tb("ngModelChange",(function(e){return t.myDate=e}))("maxChange",(function(e){return t.maxDate=e})),p.Kb(),p.Kb(),p.Lb(40,"ion-row"),p.Lb(41,"ion-col"),p.Lb(42,"ion-button",18),p.Tb("click",(function(){return t.salir()})),p.pc(43,"Salir"),p.Kb(),p.Kb(),p.Lb(44,"ion-col"),p.Lb(45,"ion-button",19),p.Tb("click",(function(){return t.save()})),p.pc(46,"Aceptar"),p.Kb(),p.Kb(),p.Kb(),p.Kb(),p.Lb(47,"ion-header",0),p.Lb(48,"ion-toolbar"),p.Lb(49,"ion-title"),p.pc(50,"Tus obras"),p.Kb(),p.Kb(),p.Kb(),p.nc(51,I,2,1,"div",1),p.Kb()),2&e&&(p.bc("translucent",!0),p.xb(2),p.bc("ngIf",t.identity),p.xb(2),p.rc("",t.total," h"),p.xb(1),p.bc("fullscreen",!0),p.xb(5),p.bc("ngModel",t.obra),p.xb(1),p.bc("ngIf",t.isItemAvailable),p.xb(4),p.bc("ngIf",t.empresa),p.xb(4),p.bc("ngModel",t.numHours),p.xb(4),p.bc("value",t.tipo)("ngModel",t.tipo),p.xb(7),p.bc("ngIf","P"!=t.tipo),p.xb(1),p.bc("ngIf",t.capitulos),p.xb(4),p.bc("ngModel",t.observations),p.xb(4),p.bc("ngModel",t.myDate)("max",t.maxDate),p.xb(6),p.bc("disabled",!t.obra||!t.numHours||t.numHours<=0||"-"===t.numHours||""===t.capitulo||"M"==t.tipo&&""===t.maquina||"X"==t.tipo&&""===t.maquina),p.xb(2),p.bc("translucent",!0),p.xb(4),p.bc("ngIf",t.tareas))},directives:[o.i,o.B,r.j,o.g,s.j,s.e,s.f,o.l,o.p,o.t,o.J,s.d,s.g,o.k,o.G,s.h,s.i,o.u,o.I,o.v,o.z,o.h,o.s,o.f,o.c,o.A,o.q,r.i,o.o,o.n,o.m,o.j],styles:["h4[_ngcontent-%COMP%]{margin-right:1rem}ion-label[_ngcontent-%COMP%]{opacity:1!important}"]}),L)}],D=((y=function t(){e(this,t)}).\u0275mod=p.Gb({type:y}),y.\u0275inj=p.Fb({factory:function(e){return new(e||y)},imports:[[c.i.forChild(K)],c.i]}),y),k=((A=function t(){e(this,t)}).\u0275mod=p.Gb({type:A}),A.\u0275inj=p.Fb({factory:function(e){return new(e||A)},imports:[[o.C,r.b,s.a,D]]}),A)}}])}();