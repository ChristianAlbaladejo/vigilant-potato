!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{tmrb:function(n,r,a){"use strict";a.r(r),a.d(r,"Tab1PageModule",(function(){return A}));var i=a("TEn/"),o=a("ofXK"),s=a("3Pt+"),c=a("tyNb"),b=a("mrSG"),l=a("tk/3"),u=a("AytR"),d=a("fXoL");function h(e,t){if(1&e&&(d.Lb(0,"ion-title"),d.pc(1),d.Kb()),2&e){var n=d.Vb();d.xb(1),d.rc(" Hola ",n.identity[0].NOMBRE," ")}}function p(e,t){if(1&e){var n=d.Mb();d.Lb(0,"ion-item",15),d.Tb("click",(function(){d.jc(n);var e=t.$implicit;return d.Vb(2).obraSelected(e)})),d.pc(1),d.Kb()}if(2&e){var r=t.$implicit;d.xb(1),d.sc("",r.DESCRIPCION," - ",r.OBRA,"")}}function m(e,t){if(1&e&&(d.Lb(0,"ion-list"),d.nc(1,p,2,2,"ion-item",14),d.Kb()),2&e){var n=d.Vb();d.xb(1),d.bc("ngForOf",n.obras)}}function f(e,t){if(1&e){var n=d.Mb();d.Lb(0,"ion-input",16),d.Tb("ngModelChange",(function(e){return d.jc(n),d.Vb().empresa.DESCRIPCION=e})),d.Kb()}if(2&e){var r=d.Vb();d.bc("ngModel",r.empresa.DESCRIPCION)("readonly",!0)}}function g(e,t){if(1&e){var n=d.Mb();d.Lb(0,"ion-item-sliding"),d.Lb(1,"ion-item"),d.Lb(2,"ion-label"),d.pc(3),d.Kb(),d.Kb(),d.Lb(4,"ion-item-options"),d.Lb(5,"ion-item-option",18),d.Tb("click",(function(){d.jc(n);var e=t.$implicit;return d.Vb(2).delete(e)})),d.Jb(6,"ion-icon",19),d.Kb(),d.Kb(),d.Kb()}if(2&e){var r=t.$implicit;d.xb(3),d.sc(" ",r.DESCRIPCION,", ",r.CANTIDAD," h ")}}function v(e,t){if(1&e&&(d.Lb(0,"div"),d.nc(1,g,7,2,"ion-item-sliding",17),d.Kb()),2&e){var n=d.Vb();d.xb(1),d.bc("ngForOf",n.tareas)}}var y,x,C,I=[{path:"",component:(y=function(){function n(t,r,a,i,o){e(this,n),this.navCtrl=t,this.loading=r,this.router=a,this.alert=i,this.http=o,this.myDate=(new Date).toISOString(),this.observations="",this.isItemAvailable=!1,this.items=[],this.load()}var r,a,i;return r=n,(a=[{key:"initializeItems",value:function(){this.items=["Obra1 - 1234","Obra2 - 4321","Obra3 - 7894"]}},{key:"ngOnInit",value:function(){this.load()}},{key:"getItems",value:function(e){var t=e.target.value;t&&""!==t.trim()?(this.isItemAvailable=!0,this.items=this.items.filter((function(e){return e.toLowerCase().indexOf(t.toLowerCase())>-1}))):this.isItemAvailable=!1}},{key:"obraSelected",value:function(e){var t=this;this.obra=e.DESCRIPCION,this.obra_id=e.OBRA,this.isItemAvailable=!1,this.http.get(u.a.API+"/empresa/"+e.EMPRESA).subscribe((function(e){t.empresa=e,t.empresa=JSON.parse(t.empresa),t.empresa=t.empresa[0]}))}},{key:"load",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=(t=JSON.parse(localStorage.getItem("identity")))?(this.identity=JSON.parse(t),console.log(this.identity)):this.router.navigateByUrl("/login");try{this.http.get(u.a.API+"/"+this.identity[0].EMPRESA).subscribe((function(e){return Object(b.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.obras=e,this.obras=JSON.parse(this.obras),this.http.get(u.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){n.total=0,n.tareas=e,n.tareas=JSON.parse(n.tareas);for(var t=0;t<n.tareas.length;t++)n.tareas[t].CANTIDAD=parseFloat(n.tareas[t].CANTIDAD).toFixed(2),n.total=(parseFloat(n.tareas[t].CANTIDAD)+parseFloat(n.total||0)).toFixed(1)}));case 1:case"end":return t.stop()}}),t,this)})))}),(function(e){return Object(b.a)(n,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al cargar los datos.",buttons:[{text:"Ok",role:"cancel",handler:function(){n.load()}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}}),e,this)})))}))}catch(r){console.log(r)}case 3:case"end":return e.stop()}}),e,this)})))}},{key:"save",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,a,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.empresa||null==this.obra_id||null==this.identity[0]||null==this.numHours||null==this.observations){e.next=10;break}return t={empresa:this.empresa.EMPRESA,obra:this.obra_id,fecha:this.myDate.slice(0,10),codigo:this.identity[0].COD_PERSONAL,descripcion:this.observations,cantidad:this.numHours},n=this.loading.create({message:"Por favor espere..."}),e.next=4,n;case 4:return e.sent.present(),r=(new l.c).set("Content-Type","application/json").set("Accept","*/*"),e.next=8,this.http.post(u.a.API+"/save/",t,{headers:r}).subscribe((function(e){return Object(b.a)(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get(u.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){t.total=0,t.tareas=e,t.tareas=JSON.parse(t.tareas);for(var n=0;n<t.tareas.length;n++)t.tareas[n].CANTIDAD=parseFloat(t.tareas[n].CANTIDAD).toFixed(2),t.total=(parseFloat(t.tareas[n].CANTIDAD)+parseFloat(t.total||0)).toFixed(1)}));case 2:return this.empresa.EMPRESA=null,this.observations="",this.numHours=0,this.obra=null,e.next=8,n;case 8:e.sent.dismiss();case 9:case"end":return e.stop()}}),e,this)})))}),(function(e){return Object(b.a)(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Error al enviar tu trabajo.",buttons:["OK"]});case 2:return t=e.sent,e.next=5,n;case 5:return e.sent.dismiss(),e.next=8,t.present();case 8:case"end":return e.stop()}}),e,this)})))}));case 8:e.next=16;break;case 10:return console.log(this.empresa,this.obra_id,this.identity[0],this.numHours),e.next=13,this.alert.create({cssClass:"my-custom-class",header:"Error",subHeader:"",message:"Por favor rellene el formulario .",buttons:["OK"]});case 13:return a=e.sent,e.next=16,a.present();case 16:case"end":return e.stop()}}),e,this)})))}},{key:"salir",value:function(){window.localStorage.removeItem("identity"),this.navCtrl.navigateRoot("/login")}},{key:"delete",value:function(e){var t=this;this.http.delete(u.a.API+"/delete/"+e.LINEA+"/"+e.FECHA+"/"+e.OBRA+"/"+this.identity[0].COD_PERSONAL).subscribe((function(e){return Object(b.a)(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get(u.a.API+"/workday/"+this.identity[0].COD_PERSONAL).subscribe((function(e){t.total=0,t.tareas=e,t.tareas=JSON.parse(t.tareas);for(var n=0;n<t.tareas.length;n++)t.tareas[n].CANTIDAD=parseFloat(t.tareas[n].CANTIDAD).toFixed(2),t.total=(parseFloat(t.tareas[n].CANTIDAD)+parseFloat(t.total||0)).toFixed(1);console.log(t.tareas)}));case 2:case"end":return e.stop()}}),e,this)})))}))}}])&&t(r.prototype,a),i&&t(r,i),n}(),y.\u0275fac=function(e){return new(e||y)(d.Ib(i.D),d.Ib(i.C),d.Ib(c.g),d.Ib(i.a),d.Ib(l.a))},y.\u0275cmp=d.Cb({type:y,selectors:[["app-tab1"]],decls:40,vars:14,consts:[[3,"translucent"],[4,"ngIf"],["slot","end"],[3,"fullscreen"],["lines","full"],["position","stacked"],["type","text","debounce","600","name","obra","placeholder","Buscar obra",3,"ngModel","ngModelChange","ionInput"],["position","floating"],["placeholder","Empresa de la obra","name","empresa","type","text",3,"ngModel","readonly","ngModelChange",4,"ngIf"],["name","numhours","pattern","^[1-9]{1,3}$|^[0-9]{1,3}\\.[0-9]{1,3}$","clearOnEdit","true","inputmode","numeric","min","0","type","number","required","",3,"ngModel","ngModelChange"],["name","observations","placeholder","Tus observaciones...",3,"ngModel","ngModelChange"],["name","time","displayFormat","DD/MM/YYYY","pickerFormat","DD/MM/YYYY",3,"ngModel","max","ngModelChange","maxChange"],["type","button","color","danger","expand","block",3,"click"],["type","submit","color","success","expand","block",3,"disabled","click"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["placeholder","Empresa de la obra","name","empresa","type","text",3,"ngModel","readonly","ngModelChange"],[4,"ngFor","ngForOf"],["color","danger",3,"click"],["name","trash"]],template:function(e,t){1&e&&(d.Lb(0,"ion-header",0),d.Lb(1,"ion-toolbar"),d.nc(2,h,2,1,"ion-title",1),d.Lb(3,"h4",2),d.pc(4),d.Kb(),d.Kb(),d.Kb(),d.Lb(5,"ion-content",3),d.Lb(6,"form"),d.Lb(7,"ion-item",4),d.Lb(8,"ion-label",5),d.pc(9,"Obra"),d.Kb(),d.Lb(10,"ion-searchbar",6),d.Tb("ngModelChange",(function(e){return t.obra=e}))("ionInput",(function(e){return t.getItems(e)})),d.Kb(),d.nc(11,m,2,1,"ion-list",1),d.Kb(),d.Lb(12,"ion-item",4),d.Lb(13,"ion-label",7),d.pc(14,"Empresa"),d.Kb(),d.nc(15,f,1,2,"ion-input",8),d.Kb(),d.Lb(16,"ion-item",4),d.Lb(17,"ion-label",7),d.pc(18,"Horas"),d.Kb(),d.Lb(19,"ion-input",9),d.Tb("ngModelChange",(function(e){return t.numHours=e})),d.Kb(),d.Kb(),d.Lb(20,"ion-item",4),d.Lb(21,"ion-label",7),d.pc(22,"Observaciones"),d.Kb(),d.Lb(23,"ion-textarea",10),d.Tb("ngModelChange",(function(e){return t.observations=e})),d.Kb(),d.Kb(),d.Lb(24,"ion-item",4),d.Lb(25,"ion-label",7),d.pc(26,"Fecha"),d.Kb(),d.Lb(27,"ion-datetime",11),d.Tb("ngModelChange",(function(e){return t.myDate=e}))("maxChange",(function(e){return t.myDate=e})),d.Kb(),d.Kb(),d.Lb(28,"ion-row"),d.Lb(29,"ion-col"),d.Lb(30,"ion-button",12),d.Tb("click",(function(){return t.salir()})),d.pc(31,"Salir"),d.Kb(),d.Kb(),d.Lb(32,"ion-col"),d.Lb(33,"ion-button",13),d.Tb("click",(function(){return t.save()})),d.pc(34,"Aceptar"),d.Kb(),d.Kb(),d.Kb(),d.Kb(),d.Lb(35,"ion-header",0),d.Lb(36,"ion-toolbar"),d.Lb(37,"ion-title"),d.pc(38,"Tus obras"),d.Kb(),d.Kb(),d.Kb(),d.nc(39,v,2,1,"div",1),d.Kb()),2&e&&(d.bc("translucent",!0),d.xb(2),d.bc("ngIf",t.identity),d.xb(2),d.rc("",t.total," h"),d.xb(1),d.bc("fullscreen",!0),d.xb(5),d.bc("ngModel",t.obra),d.xb(1),d.bc("ngIf",t.isItemAvailable),d.xb(4),d.bc("ngIf",t.empresa),d.xb(4),d.bc("ngModel",t.numHours),d.xb(4),d.bc("ngModel",t.observations),d.xb(4),d.bc("ngModel",t.myDate)("max",t.myDate),d.xb(6),d.bc("disabled",!t.obra||!t.numHours||t.numHours<=0||"-"===t.numHours),d.xb(2),d.bc("translucent",!0),d.xb(4),d.bc("ngIf",t.tareas))},directives:[i.i,i.z,o.j,i.g,s.j,s.e,s.f,i.l,i.p,i.t,i.H,s.d,s.g,i.k,i.E,s.h,s.i,i.x,i.h,i.G,i.s,i.f,i.c,i.y,i.q,o.i,i.o,i.n,i.m,i.j],styles:["h4[_ngcontent-%COMP%]{margin-right:1rem}ion-label[_ngcontent-%COMP%]{opacity:1!important}"]}),y)}],O=((C=function t(){e(this,t)}).\u0275mod=d.Gb({type:C}),C.\u0275inj=d.Fb({factory:function(e){return new(e||C)},imports:[[c.i.forChild(I)],c.i]}),C),A=((x=function t(){e(this,t)}).\u0275mod=d.Gb({type:x}),x.\u0275inj=d.Fb({factory:function(e){return new(e||x)},imports:[[i.A,o.b,s.a,O]]}),x)}}])}();